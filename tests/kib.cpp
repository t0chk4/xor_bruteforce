#include <memory>

#include "../src/xbf.h"

int main()
{
	const char key = 0xf1;

	std::string message = { "\xc7\xc7\xc7\xc9\x85\x87\x99\x83\xc6\x96\x81\x85\x83\x92\x8b\x92\x88\x98\x9a\x94\x9d\x9b\xc8\x82\x81\x9c\x97\x95\x93\x94\x9d\x94\x95\x85\xc0\x9f\x9b\xc7\x88\xc2\x88\xc7\x99\xc9\xc0\x80\x99\x97\x87\x96\x9f\x99\xc0\x97\x90\x92\x98\x82\xc2\x9d\x9d\xc4\x95\xc3\x9f\x87\x83\x82\x9e\xc1\x98\xc8\xc3\x95\xc0\xc4\xc6\x88\x9c\x9c\x90\xc8\x87\x87\x94\x80\x90\x89\x9e\xc2\xc8\x84\xc9\x9a\xc2\x9e\xc2\x9c\x90\x99\xc3\x9c\x98\xc6\xc4\xc5\x86\x96\xc7\xc8\xc0\x97\xc3\x98\x9f\x85\x89\xc7\x9c\x99\x87\x82\x9c\xc5\xc9\x97\xc3\x95\x95\x9e\xc7\x92\x9f\xc1\x95\xc1\x9d\x90\x9b\xc8\x9b\x87\x96\xc6\x87\xc1\x83\x9f\x94\x83\xc4\x9a\x9f\x89\x89\xc9\x88\xc4\xc6\x8b\x81\x80\xc1\x9e\xc1\x9e\xc3\x98\x98\xc9\x87\x9a\x9a\xc8\x80\xc8\x9b\x84\x83\xc6\x98\x9c\xc8\x85\xc6\x99\x98\x89\x87\xc6\x9d\x9e\x93\xc7\xc1\x83\x97\x99\x86\x97\xc1\x83\x96\x81\xc5\x90\xc5\x83\x97\xc8\xc6\x82\x85\x8b\x87\x99\x86\xc4\x89\x84\x9c\x93\x97\xc0\x9f\x9b\x90\x85\x86\x85\x89\x9d\xc3\x9a\x81\xc0\x86\x84\x87\x85\xc3\x8b\x9e\x97\xc8\x88\xc7\x85\x9a\x95\x95\xc5\x9c\x9a\x80\x9e\x8b\x97\x99\x9b\xc3\x90\xc6\xc1\x9d\xc1\x95\x9a\xc6\x9d\x98\x85\x97\x89\xc6\x95\x82\x9a\x83\x84\x87\x88\x88\xc3\x95\x93\xc9\x86\x90\x97\xc0\x9f\xc1\x90\x83\x85\xc7\x8b\x97\x9b\x94\x92\x9d\xc3\xc9\x84\x9c\xc0\xc4\x9e\x9c\x89\x86\x89\x84\x90\x9d\x97\xc2\x84\x92\x9b\x81\xc3\x90\x80\x80\x9b\x9b\x86\xc7\x99\x97\x88\x9e\xc8\x9f\xc9\x9e\x9b\x82\x9d\x86\x87\xc2\x85\x80\xc3\x9f\x9b\x8b\x9f\x83\x85\x82\xc0\x85\xc1\x83\x97\x8b\xc5\x86\xc1\x94\xc9\x98\x9b\x90\x9f\x82\x8b\x87\xc1\x92\xc1\x93\x99\x80\x80\x85\x9f\x94\xc7\x9c\x97\x85\x90\x98\x96\x84\x85\x9e\x97\x8b\x85\x82\x89\x86\xc1\x9b\xc3\x80\xc0\x9e\x89\x94\xc5\xc0\x98\x99\x9e\x96\x89\x84\x80\x9b\x9e\x9d\xc3\x84\x83\x9f\x87\x95\xc5\xc9\x9f\x9b\x8b\x88\xc4\x89\x81\xc2\xc2\x87\x98\x98\xc5\x9a\x96\xc7\x86\x9d\x85\x90\x96\x9e\x9a\x84\x81\x84\x94\xc2\x80\xc4\x97\x81\x82\x9d\xc9\x90\xc1\x9a\xc2\x92\x87\x9b\x84\xc2\x8b\x92\x86\xc3\xc3\xc6\xc6\x92\x87\x89\x89\x83\x93\x9c\x98\x9d\x84\x87\x92\x83\x80\x94\x90\x9c\x89\x9f\x88\x9a\x9e\xc8\xc8\x89\x88\xc0\x9b\xc3\xc9\x95\x94\x93\xc5\x84\x82\x92\x8b\xc8\xc5\xc3\x9c\x94\x8b\x94\x89\x85\x8b\x99\x93\x84\x9b\x96\xc2\x99\x87\x9a\x92\x85\xc3\xc1\x9e\x9f\x95\x86\x86\x94\x9d\x9a\x81\xc1\x93\x80\x9e\x95\x94\x89\x9e\xc7\xc4\xc2\x88\x81\x80\x83\xc5\x9c\xc3\x86\xc4\xc3\xc3\x85\x96\x89\x96\x9b\x86\xc8\x93\xc7\xc8\x9c\x9b\x83\x9c\x83\x89\x96\x8b\xc1\x9e\x83\xc7\x9a\x95\x92\x98\x80\x9b\x9b\x9a\xc1\xc6\x96\x92\x89\x85\x9f\x9a\x89\x88\x8b\xc3\x87\x90\x80\x83\x87\x95\x85\x9c\x9f\x93\x93\x83\xc2\x99\xc3\xc8\x90\x90\x94\x99\x97\x97\xc0\x84\x9d\xc8\x9a\x8b\x87\x9f\x94\x85\xc8\x9f\x93\x9e\xc6\x94\x89\x9d\x80\xc6\x9b\x9e\xc5\x9e\x9b\x9d\x9f\x8b\x9a\xc0\x85\x93\x99\x94\x86\x9a\xc6\xc9\x81\x93\xc9\x89\x89\x98\x83\x98\x94\x99\x94\xc2\x80\x9d\xc0\xc7\x9a\xc4\x84\xc7\x8b\x97\x9c\xc3\x9a\xc4\x82\x97\xc6\x9b\x97\x9b\x94\x92\xc1\x92\x87\x94\xc9\x86\xc7\x81\x92\xc5\x82\x90\x87\xc1\x8b\xc7\x82\x99\x92\x83\x93\xc9\x93\x82\xc7\xc4\x88\x82\x9e\x95\x95\x83\x9f\x9c\xc5\x90\x9a\x96\x8b\xc7\x99\x88\xc8\x87\x9e\xc7\x89\x9e\xc4\xc0\x90\x94\x9d\x95\x9e\xc4\x80\x92\xc4\x9d\x9f\xc5\x82\x9c\x94\xc9\x9f\xc9\x8b\x97\xc7\x95\xc9\x9a\x92\x94\xc7\x87\x93\xc3\x88\x86\x9d\x9f\x80\x89\x93\x94\x92\x85\xc5\x95\x92\x9f\x9e\x84\x85\x84\x88\xc1\x84\x9c\x9e\x81\x9c\x87\x85\x8b\x85\xc7\xc3\x9a\xc8\xc2\x85\x89\xc8\x9c\x9a\xc6\x9c\x9d\xc8\x9f\x80\xc5\x9f\x93\xc7\xc3\xc7\xc1\x99\x83\x84\x9b\xc9\x9c\xc4\x9d\x81\x95\x8b\x9b\x86\x96\x97\x9c\xc5\x9f\x98\x96\xc9\x86\xc6\x86\x90\x87\xc0\xc8\x9f\x93\x92\x85\x87\xc2\x86\x86\xc7\x89\x92\xc2\x90\x86\xc9\x98\x9e\xc5\x85\x86\x93\x82\x9f\x82\x87\x8b\x87\xc5\x9a\xc6\x85\x90\x94\x83\x99\x84\xc1\x82\x96\x9f\x82\xc8\xc1\x84\x81\x9f\x89\x97\xc3\x82\xc6\xc9\xc7\xc8\x87\x9d\xc5\xc4\x89\x9c\x92\x95\x81\x9c\x80\xc1\x95\x92\xc5\x97\x87\x81\x83\x95\x92\x98\x96\x92\xc6\x89\xc9\x85\xc1\x88\x87\x87\x94\x94\xc9\xc0\x80\x88\xc2\x93\x96\x8b\x9b\xc0\x9e\x9d\x9b\x89\x9c\x82\x87\x84\x85\x93\x9d\xc0\x85\x81\xc6\x96\x84\xc4\x90\x9c\x88\x99\xc1\x88\xc2\x90\x98\x86\xc0\xc0\xc4\x84\x87\x9e\x88\x96\x9b\xc1\xc1\xc1\x9c\xc9\x81\x83\x81\x85\xc0\x95\x98\x86\x88\x86\x93\x84\x8b\xc1\x9b\x96\x9c\xc5" };

	std::string start_kw = "666";

	xbf::Bruteforcer bf(message, std::make_unique<xbf::filters::StartsWith>(start_kw));

	bf.attack();
	std::cout << "Test " 
			  << (bf.get_key() == key ? "passed" : "failed") 
			  << std::endl;
	return 0;
}